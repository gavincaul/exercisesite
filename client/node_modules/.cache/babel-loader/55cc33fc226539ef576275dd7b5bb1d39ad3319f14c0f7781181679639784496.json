{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{signup,login}from\"../components/movementService.js\";import NavBar from\"../components/NavBar.tsx\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginPage(){var _user$user_metadata;const navigate=useNavigate();const[isSignup,setIsSignup]=useState(false);const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[inviteCode,setInviteCode]=useState(\"\");const[error,setError]=useState(null);const[loading,setLoading]=useState(false);// User state from localStorage\nconst[user,setUser]=useState(null);// On mount, load user from localStorage\nuseEffect(()=>{const storedUser=localStorage.getItem(\"user\");if(storedUser){try{setUser(JSON.parse(storedUser));}catch{localStorage.removeItem(\"user\");}}},[]);const handleSubmit=async e=>{e.preventDefault();setError(null);setLoading(true);try{if(isSignup){if(!inviteCode.trim()){setError(\"Invite code is required for signup.\");setLoading(false);return;}await signup(email,password,inviteCode);alert(\"Signup successful! Please log in.\");setIsSignup(false);}else{const data=await login(email,password);localStorage.setItem(\"user\",JSON.stringify(data.user));localStorage.setItem(\"session\",JSON.stringify(data.session));setUser(data.user);navigate(\"/workouts\");}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message||\"Unexpected error\");}finally{setLoading(false);}};const handleSignOut=()=>{localStorage.removeItem(\"user\");localStorage.removeItem(\"session\");setUser(null);setEmail(\"\");setPassword(\"\");setInviteCode(\"\");setIsSignup(false);navigate(\"/login\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"background\",children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"centerconsole\",children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h2\",{style:{textAlign:\"center\"},children:[\"You are signed in, \",user.email||((_user$user_metadata=user.user_metadata)===null||_user$user_metadata===void 0?void 0:_user$user_metadata.full_name)||\"User\",\"!\"]}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\",marginTop:\"2rem\"},children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSignOut,style:{padding:\"0.75rem 1.5rem\",backgroundColor:\"#dc3545\",color:\"white\",border:\"none\",borderRadius:6,cursor:\"pointer\",fontSize:\"1.2rem\"},children:\"Sign Out\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\"},children:isSignup?\"Sign Up\":\"Log In\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{display:\"flex\",flexDirection:\"column\",gap:\"1rem\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:email,style:{width:\"60%\",margin:\"auto\"},onChange:e=>setEmail(e.target.value),required:true,autoComplete:\"email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,style:{width:\"60%\",margin:\"auto\"},onChange:e=>setPassword(e.target.value),required:true,autoComplete:isSignup?\"new-password\":\"current-password\"}),isSignup&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Invite Code\",value:inviteCode,style:{width:\"60%\",margin:\"auto\"},onChange:e=>setInviteCode(e.target.value),required:isSignup}),error&&/*#__PURE__*/_jsx(\"p\",{style:{margin:\"auto\",color:\"red\",fontWeight:\"bold\"},children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{padding:\"0.75rem\",backgroundColor:\"#007bff\",color:\"white\",border:\"none\",borderRadius:6,cursor:\"pointer\",width:\"60%\",margin:\"auto\"},children:loading?\"Please wait...\":isSignup?\"Sign Up\":\"Log In\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{marginTop:\"1rem\",textAlign:\"center\"},children:[isSignup?\"Already have an account? \":\"Don't have an account? \",/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setError(null);setIsSignup(!isSignup);},style:{color:\"#007bff\",background:\"none\",border:\"none\",cursor:\"pointer\",textDecoration:\"underline\",padding:0},children:isSignup?\"Log In\":\"Sign Up\"})]})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","signup","login","NavBar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginPage","_user$user_metadata","navigate","isSignup","setIsSignup","email","setEmail","password","setPassword","inviteCode","setInviteCode","error","setError","loading","setLoading","user","setUser","storedUser","localStorage","getItem","JSON","parse","removeItem","handleSubmit","e","preventDefault","trim","alert","data","setItem","stringify","session","err","_err$response","_err$response$data","response","message","handleSignOut","className","children","style","textAlign","user_metadata","full_name","marginTop","onClick","padding","backgroundColor","color","border","borderRadius","cursor","fontSize","onSubmit","display","flexDirection","gap","type","placeholder","value","width","margin","onChange","target","required","autoComplete","fontWeight","disabled","background","textDecoration"],"sources":["/home/gavin/VSC/Websites/exercisesite/client/src/pages/SignupLogin.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { signup, login } from \"../components/movementService.js\";\nimport NavBar from \"../components/NavBar.tsx\";\n\nexport default function LoginPage() {\n  const navigate = useNavigate();\n  const [isSignup, setIsSignup] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [inviteCode, setInviteCode] = useState(\"\");\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  // User state from localStorage\n  const [user, setUser] = useState(null);\n\n  // On mount, load user from localStorage\n  useEffect(() => {\n    const storedUser = localStorage.getItem(\"user\");\n    if (storedUser) {\n      try {\n        setUser(JSON.parse(storedUser));\n      } catch {\n        localStorage.removeItem(\"user\");\n      }\n    }\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(null);\n    setLoading(true);\n\n    try {\n      if (isSignup) {\n        if (!inviteCode.trim()) {\n          setError(\"Invite code is required for signup.\");\n          setLoading(false);\n          return;\n        }\n        await signup(email, password, inviteCode);\n        alert(\"Signup successful! Please log in.\");\n        setIsSignup(false);\n      } else {\n        const data = await login(email, password);\n        localStorage.setItem(\"user\", JSON.stringify(data.user));\n        localStorage.setItem(\"session\", JSON.stringify(data.session));\n        setUser(data.user);\n        navigate(\"/workouts\");\n      }\n    } catch (err) {\n      setError(err.response?.data?.error || err.message || \"Unexpected error\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSignOut = () => {\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"session\");\n    setUser(null);\n    setEmail(\"\");\n    setPassword(\"\");\n    setInviteCode(\"\");\n    setIsSignup(false);\n    navigate(\"/login\");\n  };\n\n  return (\n    <div className=\"background\">\n      <NavBar />\n      <div className=\"centerconsole\" >\n        {user ? (\n          <>\n            <h2 style={{ textAlign: \"center\" }}>\n              You are signed in, {user.email || user.user_metadata?.full_name || \"User\"}!\n            </h2>\n            <div style={{ textAlign: \"center\", marginTop: \"2rem\" }}>\n              <button\n                onClick={handleSignOut}\n                style={{\n                  padding: \"0.75rem 1.5rem\",\n                  backgroundColor: \"#dc3545\",\n                  color: \"white\",\n                  border: \"none\",\n                  borderRadius: 6,\n                  cursor: \"pointer\",\n                  fontSize: \"1.2rem\",\n                }}\n              >\n                Sign Out\n              </button>\n            </div>\n          </>\n        ) : (\n          <>\n            <h2 style={{ textAlign: \"center\" }}>\n              {isSignup ? \"Sign Up\" : \"Log In\"}\n            </h2>\n            <form\n              onSubmit={handleSubmit}\n              style={{ display: \"flex\", flexDirection: \"column\", gap: \"1rem\" }}\n            >\n              <input\n                type=\"email\"\n                placeholder=\"Email\"\n                value={email}\n                style={{ width: \"60%\", margin: \"auto\" }}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                autoComplete=\"email\"\n              />\n              <input\n                type=\"password\"\n                placeholder=\"Password\"\n                value={password}\n                style={{ width: \"60%\", margin: \"auto\" }}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                autoComplete={isSignup ? \"new-password\" : \"current-password\"}\n              />\n              {isSignup && (\n                <input\n                  type=\"text\"\n                  placeholder=\"Invite Code\"\n                  value={inviteCode}\n                  style={{ width: \"60%\", margin: \"auto\" }}\n                  onChange={(e) => setInviteCode(e.target.value)}\n                  required={isSignup}\n                />\n              )}\n              {error && (\n                <p style={{ margin: \"auto\", color: \"red\", fontWeight: \"bold\" }}>\n                  {error}\n                </p>\n              )}\n              <button\n                type=\"submit\"\n                disabled={loading}\n                style={{\n                  padding: \"0.75rem\",\n                  backgroundColor: \"#007bff\",\n                  color: \"white\",\n                  border: \"none\",\n                  borderRadius: 6,\n                  cursor: \"pointer\",\n                  width: \"60%\",\n                  margin: \"auto\",\n                }}\n              >\n                {loading ? \"Please wait...\" : isSignup ? \"Sign Up\" : \"Log In\"}\n              </button>\n            </form>\n            <p style={{ marginTop: \"1rem\", textAlign: \"center\" }}>\n              {isSignup ? \"Already have an account? \" : \"Don't have an account? \"}\n              <button\n                onClick={() => {\n                  setError(null);\n                  setIsSignup(!isSignup);\n                }}\n                style={{\n                  color: \"#007bff\",\n                  background: \"none\",\n                  border: \"none\",\n                  cursor: \"pointer\",\n                  textDecoration: \"underline\",\n                  padding: 0,\n                }}\n              >\n                {isSignup ? \"Log In\" : \"Sign Up\"}\n              </button>\n            </p>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,MAAM,CAAEC,KAAK,KAAQ,kCAAkC,CAChE,MAAO,CAAAC,MAAM,KAAM,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE9C,cAAe,SAAS,CAAAC,SAASA,CAAA,CAAG,KAAAC,mBAAA,CAClC,KAAM,CAAAC,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACa,QAAQ,CAAEC,WAAW,CAAC,CAAGhB,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACiB,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACmB,QAAQ,CAAEC,WAAW,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACqB,UAAU,CAAEC,aAAa,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACuB,KAAK,CAAEC,QAAQ,CAAC,CAAGxB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACyB,OAAO,CAAEC,UAAU,CAAC,CAAG1B,QAAQ,CAAC,KAAK,CAAC,CAE7C;AACA,KAAM,CAAC2B,IAAI,CAAEC,OAAO,CAAC,CAAG5B,QAAQ,CAAC,IAAI,CAAC,CAEtC;AACAC,SAAS,CAAC,IAAM,CACd,KAAM,CAAA4B,UAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAC/C,GAAIF,UAAU,CAAE,CACd,GAAI,CACFD,OAAO,CAACI,IAAI,CAACC,KAAK,CAACJ,UAAU,CAAC,CAAC,CACjC,CAAE,KAAM,CACNC,YAAY,CAACI,UAAU,CAAC,MAAM,CAAC,CACjC,CACF,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAChCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBb,QAAQ,CAAC,IAAI,CAAC,CACdE,UAAU,CAAC,IAAI,CAAC,CAEhB,GAAI,CACF,GAAIX,QAAQ,CAAE,CACZ,GAAI,CAACM,UAAU,CAACiB,IAAI,CAAC,CAAC,CAAE,CACtBd,QAAQ,CAAC,qCAAqC,CAAC,CAC/CE,UAAU,CAAC,KAAK,CAAC,CACjB,OACF,CACA,KAAM,CAAAvB,MAAM,CAACc,KAAK,CAAEE,QAAQ,CAAEE,UAAU,CAAC,CACzCkB,KAAK,CAAC,mCAAmC,CAAC,CAC1CvB,WAAW,CAAC,KAAK,CAAC,CACpB,CAAC,IAAM,CACL,KAAM,CAAAwB,IAAI,CAAG,KAAM,CAAApC,KAAK,CAACa,KAAK,CAAEE,QAAQ,CAAC,CACzCW,YAAY,CAACW,OAAO,CAAC,MAAM,CAAET,IAAI,CAACU,SAAS,CAACF,IAAI,CAACb,IAAI,CAAC,CAAC,CACvDG,YAAY,CAACW,OAAO,CAAC,SAAS,CAAET,IAAI,CAACU,SAAS,CAACF,IAAI,CAACG,OAAO,CAAC,CAAC,CAC7Df,OAAO,CAACY,IAAI,CAACb,IAAI,CAAC,CAClBb,QAAQ,CAAC,WAAW,CAAC,CACvB,CACF,CAAE,MAAO8B,GAAG,CAAE,KAAAC,aAAA,CAAAC,kBAAA,CACZtB,QAAQ,CAAC,EAAAqB,aAAA,CAAAD,GAAG,CAACG,QAAQ,UAAAF,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcL,IAAI,UAAAM,kBAAA,iBAAlBA,kBAAA,CAAoBvB,KAAK,GAAIqB,GAAG,CAACI,OAAO,EAAI,kBAAkB,CAAC,CAC1E,CAAC,OAAS,CACRtB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAuB,aAAa,CAAGA,CAAA,GAAM,CAC1BnB,YAAY,CAACI,UAAU,CAAC,MAAM,CAAC,CAC/BJ,YAAY,CAACI,UAAU,CAAC,SAAS,CAAC,CAClCN,OAAO,CAAC,IAAI,CAAC,CACbV,QAAQ,CAAC,EAAE,CAAC,CACZE,WAAW,CAAC,EAAE,CAAC,CACfE,aAAa,CAAC,EAAE,CAAC,CACjBN,WAAW,CAAC,KAAK,CAAC,CAClBF,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,CAED,mBACEL,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,CAACF,MAAM,GAAE,CAAC,cACVE,IAAA,QAAK2C,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3BxB,IAAI,cACHlB,KAAA,CAAAE,SAAA,EAAAwC,QAAA,eACE1C,KAAA,OAAI2C,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAF,QAAA,EAAC,qBACf,CAACxB,IAAI,CAACV,KAAK,IAAAJ,mBAAA,CAAIc,IAAI,CAAC2B,aAAa,UAAAzC,mBAAA,iBAAlBA,mBAAA,CAAoB0C,SAAS,GAAI,MAAM,CAAC,GAC5E,EAAI,CAAC,cACLhD,IAAA,QAAK6C,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAQ,CAAEG,SAAS,CAAE,MAAO,CAAE,CAAAL,QAAA,cACrD5C,IAAA,WACEkD,OAAO,CAAER,aAAc,CACvBG,KAAK,CAAE,CACLM,OAAO,CAAE,gBAAgB,CACzBC,eAAe,CAAE,SAAS,CAC1BC,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,MAAM,CACdC,YAAY,CAAE,CAAC,CACfC,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,QACZ,CAAE,CAAAb,QAAA,CACH,UAED,CAAQ,CAAC,CACN,CAAC,EACN,CAAC,cAEH1C,KAAA,CAAAE,SAAA,EAAAwC,QAAA,eACE5C,IAAA,OAAI6C,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAF,QAAA,CAChCpC,QAAQ,CAAG,SAAS,CAAG,QAAQ,CAC9B,CAAC,cACLN,KAAA,SACEwD,QAAQ,CAAE9B,YAAa,CACvBiB,KAAK,CAAE,CAAEc,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAQ,CAAEC,GAAG,CAAE,MAAO,CAAE,CAAAjB,QAAA,eAEjE5C,IAAA,UACE8D,IAAI,CAAC,OAAO,CACZC,WAAW,CAAC,OAAO,CACnBC,KAAK,CAAEtD,KAAM,CACbmC,KAAK,CAAE,CAAEoB,KAAK,CAAE,KAAK,CAAEC,MAAM,CAAE,MAAO,CAAE,CACxCC,QAAQ,CAAGtC,CAAC,EAAKlB,QAAQ,CAACkB,CAAC,CAACuC,MAAM,CAACJ,KAAK,CAAE,CAC1CK,QAAQ,MACRC,YAAY,CAAC,OAAO,CACrB,CAAC,cACFtE,IAAA,UACE8D,IAAI,CAAC,UAAU,CACfC,WAAW,CAAC,UAAU,CACtBC,KAAK,CAAEpD,QAAS,CAChBiC,KAAK,CAAE,CAAEoB,KAAK,CAAE,KAAK,CAAEC,MAAM,CAAE,MAAO,CAAE,CACxCC,QAAQ,CAAGtC,CAAC,EAAKhB,WAAW,CAACgB,CAAC,CAACuC,MAAM,CAACJ,KAAK,CAAE,CAC7CK,QAAQ,MACRC,YAAY,CAAE9D,QAAQ,CAAG,cAAc,CAAG,kBAAmB,CAC9D,CAAC,CACDA,QAAQ,eACPR,IAAA,UACE8D,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,aAAa,CACzBC,KAAK,CAAElD,UAAW,CAClB+B,KAAK,CAAE,CAAEoB,KAAK,CAAE,KAAK,CAAEC,MAAM,CAAE,MAAO,CAAE,CACxCC,QAAQ,CAAGtC,CAAC,EAAKd,aAAa,CAACc,CAAC,CAACuC,MAAM,CAACJ,KAAK,CAAE,CAC/CK,QAAQ,CAAE7D,QAAS,CACpB,CACF,CACAQ,KAAK,eACJhB,IAAA,MAAG6C,KAAK,CAAE,CAAEqB,MAAM,CAAE,MAAM,CAAEb,KAAK,CAAE,KAAK,CAAEkB,UAAU,CAAE,MAAO,CAAE,CAAA3B,QAAA,CAC5D5B,KAAK,CACL,CACJ,cACDhB,IAAA,WACE8D,IAAI,CAAC,QAAQ,CACbU,QAAQ,CAAEtD,OAAQ,CAClB2B,KAAK,CAAE,CACLM,OAAO,CAAE,SAAS,CAClBC,eAAe,CAAE,SAAS,CAC1BC,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,MAAM,CACdC,YAAY,CAAE,CAAC,CACfC,MAAM,CAAE,SAAS,CACjBS,KAAK,CAAE,KAAK,CACZC,MAAM,CAAE,MACV,CAAE,CAAAtB,QAAA,CAED1B,OAAO,CAAG,gBAAgB,CAAGV,QAAQ,CAAG,SAAS,CAAG,QAAQ,CACvD,CAAC,EACL,CAAC,cACPN,KAAA,MAAG2C,KAAK,CAAE,CAAEI,SAAS,CAAE,MAAM,CAAEH,SAAS,CAAE,QAAS,CAAE,CAAAF,QAAA,EAClDpC,QAAQ,CAAG,2BAA2B,CAAG,yBAAyB,cACnER,IAAA,WACEkD,OAAO,CAAEA,CAAA,GAAM,CACbjC,QAAQ,CAAC,IAAI,CAAC,CACdR,WAAW,CAAC,CAACD,QAAQ,CAAC,CACxB,CAAE,CACFqC,KAAK,CAAE,CACLQ,KAAK,CAAE,SAAS,CAChBoB,UAAU,CAAE,MAAM,CAClBnB,MAAM,CAAE,MAAM,CACdE,MAAM,CAAE,SAAS,CACjBkB,cAAc,CAAE,WAAW,CAC3BvB,OAAO,CAAE,CACX,CAAE,CAAAP,QAAA,CAEDpC,QAAQ,CAAG,QAAQ,CAAG,SAAS,CAC1B,CAAC,EACR,CAAC,EACJ,CACH,CACE,CAAC,EACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}