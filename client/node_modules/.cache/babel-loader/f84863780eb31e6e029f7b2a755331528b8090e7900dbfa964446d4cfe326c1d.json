{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";const WorkoutContext=/*#__PURE__*/createContext(null);export function WorkoutProvider(_ref){var _exercises$;let{exercises,title,children}=_ref;const[index,setIndex]=useState(0);const[setCount,setSetCount]=useState(1);const[isResting,setIsResting]=useState(false);const[timeLeft,setTimeLeft]=useState(((_exercises$=exercises[0])===null||_exercises$===void 0?void 0:_exercises$.time)||0);const[isRunning,setIsRunning]=useState(true);const[done,setDone]=useState(false);const current=exercises[index];const totalSets=current.sets&&current.sets>0?current.sets:1;const restSeconds=current.rest||30;useEffect(()=>{if(!isRunning||done)return;const timer=setInterval(()=>{setTimeLeft(prev=>prev-1);},1000);return()=>clearInterval(timer);},[isRunning,done]);useEffect(()=>{if(timeLeft>0||done)return;if(isResting){setIsResting(false);if(setCount<=totalSets){setTimeLeft(current.time||180);}return;}if(setCount<totalSets){setIsResting(true);setTimeLeft(restSeconds);setSetCount(s=>s+1);}else if(index+1<exercises.length){setIsResting(true);setTimeLeft(restSeconds);setSetCount(1);setTimeout(()=>{setIndex(i=>i+1);},0);}else{setDone(true);setIsRunning(false);}// eslint-disable-next-line \n},[timeLeft,isResting,setCount,totalSets,current,index,exercises.length,done]);const pause=()=>setIsRunning(false);const resume=()=>setIsRunning(true);const skip=()=>{if(isResting){setIsResting(false);setTimeLeft(current.time||180);return;}if(setCount<totalSets){setSetCount(s=>s+1);setTimeLeft(exercises[index].time||180);setIsResting(false);setIsRunning(true);}else{if(index+1<exercises.length){setIndex(index+1);setSetCount(1);setIsResting(false);setTimeLeft(exercises[index+1].time||180);}else{setDone(true);setIsRunning(false);}}};const reset=()=>{var _exercises$index;setSetCount(1);setIsResting(false);setTimeLeft(((_exercises$index=exercises[index])===null||_exercises$index===void 0?void 0:_exercises$index.time)||0);setDone(false);setIsRunning(true);};const handleSetIndex=newIndex=>{var _exercises$newIndex;setIndex(newIndex);setSetCount(1);setIsResting(false);setTimeLeft(((_exercises$newIndex=exercises[newIndex])===null||_exercises$newIndex===void 0?void 0:_exercises$newIndex.time)||180);setIsRunning(false);};return/*#__PURE__*/_jsx(WorkoutContext.Provider,{value:{title,current,exercises,timeLeft,index,isRunning,isResting,setCount,pause,resume,skip,reset,done,restSeconds,setIndex:handleSetIndex},children:children});}export function useWorkout(){const ctx=useContext(WorkoutContext);if(!ctx)throw new Error(\"useWorkout must be used within WorkoutProvider\");return ctx;}","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","jsx","_jsx","WorkoutContext","WorkoutProvider","_ref","_exercises$","exercises","title","children","index","setIndex","setCount","setSetCount","isResting","setIsResting","timeLeft","setTimeLeft","time","isRunning","setIsRunning","done","setDone","current","totalSets","sets","restSeconds","rest","timer","setInterval","prev","clearInterval","s","length","setTimeout","i","pause","resume","skip","reset","_exercises$index","handleSetIndex","newIndex","_exercises$newIndex","Provider","value","useWorkout","ctx","Error"],"sources":["/home/gavin/VSC/Websites/exercisesite/client/src/components/WorkoutProvider.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from \"react\";\n\nimport { Exercise } from \"../interfaces/exercise.tsx\";\nimport { WorkoutContextType } from \"../interfaces/workout.tsx\";\n\nconst WorkoutContext = createContext(\n  null as unknown as WorkoutContextType | null\n);\n\nexport function WorkoutProvider({\n  exercises,\n  title,\n  children,\n}: {\n  exercises: Exercise[];\n  title: string;\n  children: React.ReactNode;\n}) {\n  const [index, setIndex] = useState(0);\n  const [setCount, setSetCount] = useState(1);\n  const [isResting, setIsResting] = useState(false);\n  const [timeLeft, setTimeLeft] = useState(exercises[0]?.time || 0);\n  const [isRunning, setIsRunning] = useState(true);\n  const [done, setDone] = useState(false);\n  const current = exercises[index];\n  const totalSets = current.sets && current.sets > 0 ? current.sets : 1;\n  const restSeconds = current.rest || 30;\n\n  useEffect(() => {\n    if (!isRunning || done) return;\n\n    const timer = setInterval(() => {\n      setTimeLeft((prev) => prev - 1);\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [isRunning, done]);\n\n  useEffect(() => {\n    if (timeLeft > 0 || done) return;\n\n    if (isResting) {\n\n      setIsResting(false);\n      if (setCount <= totalSets) {\n        setTimeLeft(current.time || 180);\n      }\n      return;\n    }\n    \n    if (setCount < totalSets) {\n  \n      setIsResting(true);\n      setTimeLeft(restSeconds);\n      setSetCount((s) => s + 1);\n    } else if (index + 1 < exercises.length) {\n     \n      setIsResting(true);\n      setTimeLeft(restSeconds);\n      setSetCount(1);\n      setTimeout(() => {\n        setIndex((i) => i + 1);\n      }, 0); \n    } else {\n\n      setDone(true);\n      setIsRunning(false);\n    }\n    // eslint-disable-next-line \n  }, [timeLeft, isResting, setCount, totalSets, current, index, exercises.length, done]);\n\n  const pause = () => setIsRunning(false);\n  const resume = () => setIsRunning(true);\n  const skip = () => {\n    if (isResting) {\n      setIsResting(false);\n      setTimeLeft(current.time || 180);\n      return;\n    }\n    if (setCount < totalSets ) {\n        setSetCount((s) => s + 1);\n        setTimeLeft(exercises[index].time || 180);\n        setIsResting(false);\n        setIsRunning(true);\n    }\n    else{\n    if (index + 1 < exercises.length) {\n      setIndex(index + 1);\n      setSetCount(1);\n      setIsResting(false);\n      setTimeLeft(exercises[index + 1].time || 180);\n    } else {\n      setDone(true);\n      setIsRunning(false);\n    }\n}\n  };\n\n  const reset = () => {\n    setSetCount(1);\n    setIsResting(false);\n    setTimeLeft(exercises[index]?.time || 0);\n    setDone(false);\n    setIsRunning(true);\n  };\n  const handleSetIndex = (newIndex: number) => {\n    setIndex(newIndex);\n    setSetCount(1);\n    setIsResting(false);\n    setTimeLeft(exercises[newIndex]?.time || 180);\n    setIsRunning(false);  \n  };\n  return (\n    <WorkoutContext.Provider\n      value={{\n        title,\n        current,\n        exercises,\n        timeLeft,\n        index,\n        isRunning,\n        isResting,\n        setCount,\n        pause,\n        resume,\n        skip,\n        reset,\n        done,\n        restSeconds,\n        setIndex: handleSetIndex,\n      }}\n    >\n      {children}\n    </WorkoutContext.Provider>\n  );\n}\n\nexport function useWorkout() {\n  const ctx = useContext(WorkoutContext);\n  if (!ctx) throw new Error(\"useWorkout must be used within WorkoutProvider\");\n  return ctx;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}